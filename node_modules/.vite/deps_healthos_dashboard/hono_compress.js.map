{
  "version": 3,
  "sources": ["../../hono/dist/utils/compress.js", "../../hono/dist/middleware/compress/index.js"],
  "sourcesContent": ["// src/utils/compress.ts\nvar COMPRESSIBLE_CONTENT_TYPE_REGEX = /^\\s*(?:text\\/(?!event-stream(?:[;\\s]|$))[^;\\s]+|application\\/(?:javascript|json|xml|xml-dtd|ecmascript|dart|postscript|rtf|tar|toml|vnd\\.dart|vnd\\.ms-fontobject|vnd\\.ms-opentype|wasm|x-httpd-php|x-javascript|x-ns-proxy-autoconfig|x-sh|x-tar|x-virtualbox-hdd|x-virtualbox-ova|x-virtualbox-ovf|x-virtualbox-vbox|x-virtualbox-vdi|x-virtualbox-vhd|x-virtualbox-vmdk|x-www-form-urlencoded)|font\\/(?:otf|ttf)|image\\/(?:bmp|vnd\\.adobe\\.photoshop|vnd\\.microsoft\\.icon|vnd\\.ms-dds|x-icon|x-ms-bmp)|message\\/rfc822|model\\/gltf-binary|x-shader\\/x-fragment|x-shader\\/x-vertex|[^;\\s]+?\\+(?:json|text|xml|yaml))(?:[;\\s]|$)/i;\nexport {\n  COMPRESSIBLE_CONTENT_TYPE_REGEX\n};\n", "// src/middleware/compress/index.ts\nimport { COMPRESSIBLE_CONTENT_TYPE_REGEX } from \"../../utils/compress.js\";\nvar ENCODING_TYPES = [\"gzip\", \"deflate\"];\nvar cacheControlNoTransformRegExp = /(?:^|,)\\s*?no-transform\\s*?(?:,|$)/i;\nvar compress = (options) => {\n  const threshold = options?.threshold ?? 1024;\n  return async function compress2(ctx, next) {\n    await next();\n    const contentLength = ctx.res.headers.get(\"Content-Length\");\n    if (ctx.res.headers.has(\"Content-Encoding\") || ctx.res.headers.has(\"Transfer-Encoding\") || ctx.req.method === \"HEAD\" || contentLength && Number(contentLength) < threshold || !shouldCompress(ctx.res) || !shouldTransform(ctx.res)) {\n      return;\n    }\n    const accepted = ctx.req.header(\"Accept-Encoding\");\n    const encoding = options?.encoding ?? ENCODING_TYPES.find((encoding2) => accepted?.includes(encoding2));\n    if (!encoding || !ctx.res.body) {\n      return;\n    }\n    const stream = new CompressionStream(encoding);\n    ctx.res = new Response(ctx.res.body.pipeThrough(stream), ctx.res);\n    ctx.res.headers.delete(\"Content-Length\");\n    ctx.res.headers.set(\"Content-Encoding\", encoding);\n  };\n};\nvar shouldCompress = (res) => {\n  const type = res.headers.get(\"Content-Type\");\n  return type && COMPRESSIBLE_CONTENT_TYPE_REGEX.test(type);\n};\nvar shouldTransform = (res) => {\n  const cacheControl = res.headers.get(\"Cache-Control\");\n  return !cacheControl || !cacheControlNoTransformRegExp.test(cacheControl);\n};\nexport {\n  compress\n};\n"],
  "mappings": ";;;AACA,IAAI,kCAAkC;;;ACCtC,IAAI,iBAAiB,CAAC,QAAQ,SAAS;AACvC,IAAI,gCAAgC;AACpC,IAAI,WAAW,CAAC,YAAY;AAC1B,QAAM,YAAY,SAAS,aAAa;AACxC,SAAO,eAAe,UAAU,KAAK,MAAM;AACzC,UAAM,KAAK;AACX,UAAM,gBAAgB,IAAI,IAAI,QAAQ,IAAI,gBAAgB;AAC1D,QAAI,IAAI,IAAI,QAAQ,IAAI,kBAAkB,KAAK,IAAI,IAAI,QAAQ,IAAI,mBAAmB,KAAK,IAAI,IAAI,WAAW,UAAU,iBAAiB,OAAO,aAAa,IAAI,aAAa,CAAC,eAAe,IAAI,GAAG,KAAK,CAAC,gBAAgB,IAAI,GAAG,GAAG;AACnO;AAAA,IACF;AACA,UAAM,WAAW,IAAI,IAAI,OAAO,iBAAiB;AACjD,UAAM,WAAW,SAAS,YAAY,eAAe,KAAK,CAAC,cAAc,UAAU,SAAS,SAAS,CAAC;AACtG,QAAI,CAAC,YAAY,CAAC,IAAI,IAAI,MAAM;AAC9B;AAAA,IACF;AACA,UAAM,SAAS,IAAI,kBAAkB,QAAQ;AAC7C,QAAI,MAAM,IAAI,SAAS,IAAI,IAAI,KAAK,YAAY,MAAM,GAAG,IAAI,GAAG;AAChE,QAAI,IAAI,QAAQ,OAAO,gBAAgB;AACvC,QAAI,IAAI,QAAQ,IAAI,oBAAoB,QAAQ;AAAA,EAClD;AACF;AACA,IAAI,iBAAiB,CAAC,QAAQ;AAC5B,QAAM,OAAO,IAAI,QAAQ,IAAI,cAAc;AAC3C,SAAO,QAAQ,gCAAgC,KAAK,IAAI;AAC1D;AACA,IAAI,kBAAkB,CAAC,QAAQ;AAC7B,QAAM,eAAe,IAAI,QAAQ,IAAI,eAAe;AACpD,SAAO,CAAC,gBAAgB,CAAC,8BAA8B,KAAK,YAAY;AAC1E;",
  "names": []
}
